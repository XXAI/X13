<section fxLayout="column" fxLayoutGap="10px" fxLayoutAlign="start" style="padding:10px; height: 100%; overflow: auto; flex: 1 1 0%;">
    <div class="data-loading-shade" *ngIf="isLoading"><mat-spinner></mat-spinner></div>
    <section fxFlex="none" fxLayout="row raw" style="overflow: auto;">
        <div fxFlex="33" *ngFor="let usuario of listaUsuarios" style="padding:5px;">
            <mat-card style="font-size: smaller;"> 
                <mat-card-header>
                    <div mat-card-avatar>
                        <img src="{{usuario.avatar}}" alt="" style="width:auto; margin:auto">
                    </div>
                    <mat-card-title>{{usuario.username}}</mat-card-title>
                    <mat-card-subtitle>{{usuario.email}}</mat-card-subtitle>
                </mat-card-header>
                <mat-divider></mat-divider>
                <mat-card-content>
                    <mat-list role="list" dense>
                        <div mat-subheader>Datos del Usuario:</div>
                        <mat-list-item role="listitem">{{usuario.name}}</mat-list-item>
                        <div mat-subheader>Almacenes:</div>
                        <mat-list-item role="listitem" *ngIf="usuario.almacenes.length == 0">Sin Almacenes Asignados</mat-list-item>
                        <mat-list-item role="listitem" *ngFor="let almacen of usuario.almacenes">{{almacen.nombre}}</mat-list-item>
                    </mat-list>
                </mat-card-content>
                <mat-divider></mat-divider>
                <mat-card-actions>
                    <button mat-button *ngIf="usuarioEdicion != usuario.id" (click)="editarUsuario(usuario.id)"><mat-icon>tune</mat-icon> Almacenes</button>
                    <div fxLayout="column" *ngIf="usuarioEdicion == usuario.id">
                        <mat-form-field fxFlex appearance="fill">
                            <mat-label>Almacenes</mat-label>
                            <mat-select [(ngModel)]="almacenesSeleccionados" multiple>
                              <mat-select-trigger>
                                {{almacenesSeleccionados.length ? almacenesSeleccionados[0].nombre : ''}}
                                <span *ngIf="almacenesSeleccionados.length > 1" class="seleccion-adicional">
                                  (+{{almacenesSeleccionados.length - 1}})
                                </span>
                              </mat-select-trigger>
                              <mat-option *ngIf="catalogoAlmacenes.length == 0" [value]="" disabled>Sin Almacenes Capturados</mat-option>
                              <mat-option *ngFor="let almacen of catalogoAlmacenes" [value]="almacen">{{almacen.nombre}}</mat-option>
                            </mat-select>
                        </mat-form-field>
                        <div fxFlex="none" fxLayout="row">
                            <div fxFlex></div>
                            <button mat-icon-button fxFlex="none" (click)="cancelar()"><mat-icon>clear</mat-icon></button>
                            <button mat-icon-button color="primary" fxFlex="none" (click)="guardar()"><mat-icon>save</mat-icon></button>
                        </div>
                    </div>
                </mat-card-actions>
            </mat-card>
        </div>
    </section>
</section>